{"ast":null,"code":"import _toConsumableArray from \"D:\\\\react-way-of-samurai\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"D:\\\\react-way-of-samurai\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\n\nvar _this = this;\n\nimport { userAPI } from \"../api/api\";\nvar FOLLOW = \"FOLLOW\";\nvar UNFOLLOW = \"UNFOLLOW\";\nvar SET_USERS = 'SET-USERS';\nvar SET_CURRENT_PAGE = 'SET-CURRENT-PAGE';\nvar SET_TOTAL_USERS_COUNT = 'SET-TOTAL-USERS-COUNT';\nvar ON_NUMBER_CHANGE = 'ON-NUMBER-CHANGE';\nvar SEARCH_NUMBER = 'SEARCH-NUMBER';\nvar TOGGLE_IS_FETCHING = 'TOGGLE-IS-FETCHING';\nvar TOGGLE_IS_FETCHING_PROGRESS = 'TOGGLE-IS-FETCHING-PROGRESS';\nvar initialState = {\n  users: [\n    /*\r\n    {\r\n        id: 1,\r\n        ava: 'http://zhaba.ru/storage-10667/images-4356/7da28183c1ca335727f6033007c24c3f_74356.gif',\r\n        followed: true,\r\n        fullName: 'Andry',\r\n        status: 'Сижу кушаю',\r\n        location: {city: 'Dnipro', country: 'Ukraine'}\r\n    },\r\n    {\r\n        id: 2,\r\n        ava: 'http://zhaba.ru/storage-10667/images-4356/2ec52d3e31cc84526b5c1b8d332bb5f2_74356.gif',\r\n        followed: false,\r\n        fullName: 'Viktoriya',\r\n        status: 'на море',\r\n        location: {city: 'Poltava', country: 'Ukraine'}\r\n    },\r\n    {\r\n        id: 3,\r\n        ava: 'http://zhaba.ru/storage-10667/images-4356/54c86b4b33e968bb15eeea983d72a850_74356.gif',\r\n        followed: true,\r\n        fullName: 'Natalia',\r\n        status: 'в астрале',\r\n        location: {city: 'Dnipro', country: 'Ukraine'}\r\n    },\r\n    {\r\n        id: 4,\r\n        ava: 'http://zhaba.ru/storage-10667/images-4356/05f88dffdf9a406fe9b0bee9df3160a5_74356.gif',\r\n        followed: false,\r\n        fullName: 'Dmitry',\r\n        status: 'я Сенсей',\r\n        location: {city: 'Minsk', country: 'Belarus'}\r\n    },\r\n    */\n  ],\n  pageSize: 5,\n  totalUsersCount: 0,\n  currentPage: 1,\n  numberChange: '',\n  isFetching: false,\n  followingInProgress: []\n};\nexport var usersReducer = function usersReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case FOLLOW:\n      return _objectSpread({}, state, {\n        users: state.users.map(function (u) {\n          if (u.id === action.userId) {\n            return _objectSpread({}, u, {\n              followed: true\n            });\n          }\n\n          return u;\n        })\n      });\n\n    case UNFOLLOW:\n      return _objectSpread({}, state, {\n        users: state.users.map(function (u) {\n          if (u.id === action.userId) {\n            return _objectSpread({}, u, {\n              followed: false\n            });\n          }\n\n          return u;\n        })\n      });\n\n    case SET_USERS:\n      {\n        return _objectSpread({}, state, {\n          users: _toConsumableArray(action.users)\n        });\n      }\n\n    case SET_CURRENT_PAGE:\n      {\n        return _objectSpread({}, state, {\n          currentPage: action.currentPage\n        });\n      }\n\n    case SET_TOTAL_USERS_COUNT:\n      {\n        return _objectSpread({}, state, {\n          totalUsersCount: action.totalCount\n        });\n      }\n\n    case ON_NUMBER_CHANGE:\n      {\n        return _objectSpread({}, state, {\n          numberChange: action.number\n        });\n      }\n\n    case SEARCH_NUMBER:\n      {\n        if (state.numberChange >= 1 && state.numberChange <= state.totalUsersCount / state.pageSize) {\n          return _objectSpread({}, state, {\n            currentPage: state.numberChange\n          });\n        } else {\n          return _objectSpread({}, state, {\n            currentPage: 1\n          });\n        }\n      }\n\n    case TOGGLE_IS_FETCHING:\n      {\n        {\n          return _objectSpread({}, state, {\n            isFetching: action.isFetching\n          });\n        }\n      }\n\n    case TOGGLE_IS_FETCHING_PROGRESS:\n      {\n        {\n          return _objectSpread({}, state, {\n            followingInProgress: action.isFetching ? _toConsumableArray(state.followingInProgress).concat([action.userId]) : state.followingInProgress.filter(function (id) {\n              return id != action.userId;\n            })\n          });\n        }\n      }\n\n    default:\n      return state;\n  } //return state;\n\n};\nexport var follow = function follow(userId) {\n  return {\n    type: FOLLOW,\n    userId: userId\n  };\n};\nexport var unFollow = function unFollow(userId) {\n  return {\n    type: UNFOLLOW,\n    userId: userId\n  };\n};\nexport var setUsers = function setUsers(users) {\n  return {\n    type: SET_USERS,\n    users: users\n  };\n};\nexport var setCurrentPage = function setCurrentPage(currentPage) {\n  return {\n    type: SET_CURRENT_PAGE,\n    currentPage: currentPage\n  };\n};\nexport var setTotalUsersCount = function setTotalUsersCount(totalCount) {\n  return {\n    type: SET_TOTAL_USERS_COUNT,\n    totalCount: totalCount\n  };\n};\nexport var onNumberChange = function onNumberChange(number) {\n  return {\n    type: ON_NUMBER_CHANGE,\n    number: number\n  };\n};\nexport var searchNumber = function searchNumber() {\n  return {\n    type: SEARCH_NUMBER\n  };\n};\nexport var toggleIsFetching = function toggleIsFetching(isFetching) {\n  return {\n    type: TOGGLE_IS_FETCHING,\n    isFetching: isFetching\n  };\n};\nexport var toggleIsFetchingProgress = function toggleIsFetchingProgress(isFetching, userId) {\n  return {\n    type: TOGGLE_IS_FETCHING_PROGRESS,\n    isFetching: isFetching,\n    userId: userId\n  };\n};\nexport var getUsersThunk = function getUsersThunk(dispatch) {\n  dispatch(toggleIsFetching(true));\n  userAPI.getUsers(_this.props.currentPage, _this.props.pageSize).then(function (data) {\n    dispatch(toggleIsFetching(false));\n    dispatch(setUsers(data.items));\n    dispatch(setTotalUsersCount(data.totalCount));\n  });\n};","map":{"version":3,"sources":["D:\\react-way-of-samurai\\src\\redux\\usersReducer.js"],"names":["userAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","ON_NUMBER_CHANGE","SEARCH_NUMBER","TOGGLE_IS_FETCHING","TOGGLE_IS_FETCHING_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","numberChange","isFetching","followingInProgress","usersReducer","state","action","type","map","u","id","userId","followed","totalCount","number","filter","follow","unFollow","setUsers","setCurrentPage","setTotalUsersCount","onNumberChange","searchNumber","toggleIsFetching","toggleIsFetchingProgress","getUsersThunk","dispatch","getUsers","props","then","data","items"],"mappings":"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","sourcesContent":["import {userAPI} from \"../api/api\";\r\n\r\nconst FOLLOW = \"FOLLOW\";\r\nconst UNFOLLOW = \"UNFOLLOW\";\r\nconst SET_USERS = 'SET-USERS';\r\nconst SET_CURRENT_PAGE = 'SET-CURRENT-PAGE';\r\nconst SET_TOTAL_USERS_COUNT = 'SET-TOTAL-USERS-COUNT';\r\nconst ON_NUMBER_CHANGE = 'ON-NUMBER-CHANGE';\r\nconst SEARCH_NUMBER = 'SEARCH-NUMBER';\r\nconst TOGGLE_IS_FETCHING = 'TOGGLE-IS-FETCHING';\r\nconst TOGGLE_IS_FETCHING_PROGRESS = 'TOGGLE-IS-FETCHING-PROGRESS';\r\nlet initialState = {\r\n    users: [\r\n        /*\r\n        {\r\n            id: 1,\r\n            ava: 'http://zhaba.ru/storage-10667/images-4356/7da28183c1ca335727f6033007c24c3f_74356.gif',\r\n            followed: true,\r\n            fullName: 'Andry',\r\n            status: 'Сижу кушаю',\r\n            location: {city: 'Dnipro', country: 'Ukraine'}\r\n        },\r\n        {\r\n            id: 2,\r\n            ava: 'http://zhaba.ru/storage-10667/images-4356/2ec52d3e31cc84526b5c1b8d332bb5f2_74356.gif',\r\n            followed: false,\r\n            fullName: 'Viktoriya',\r\n            status: 'на море',\r\n            location: {city: 'Poltava', country: 'Ukraine'}\r\n        },\r\n        {\r\n            id: 3,\r\n            ava: 'http://zhaba.ru/storage-10667/images-4356/54c86b4b33e968bb15eeea983d72a850_74356.gif',\r\n            followed: true,\r\n            fullName: 'Natalia',\r\n            status: 'в астрале',\r\n            location: {city: 'Dnipro', country: 'Ukraine'}\r\n        },\r\n        {\r\n            id: 4,\r\n            ava: 'http://zhaba.ru/storage-10667/images-4356/05f88dffdf9a406fe9b0bee9df3160a5_74356.gif',\r\n            followed: false,\r\n            fullName: 'Dmitry',\r\n            status: 'я Сенсей',\r\n            location: {city: 'Minsk', country: 'Belarus'}\r\n        },\r\n    */\r\n    ],\r\n    pageSize: 5,\r\n    totalUsersCount: 0,\r\n    currentPage: 1,\r\n    numberChange: '',\r\n    isFetching: false,\r\n    followingInProgress: [],\r\n};\r\n\r\nexport const usersReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case FOLLOW:\r\n            return {\r\n                ...state,\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userId) {\r\n                        return {...u, followed: true}\r\n                    }\r\n                    return u;\r\n                })\r\n            }\r\n        case UNFOLLOW:\r\n            return {\r\n                ...state,\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userId) {\r\n                        return {...u, followed: false}\r\n                    }\r\n                    return u;\r\n                })\r\n            }\r\n        case SET_USERS: {\r\n            return {\r\n                ...state, users: [...action.users]\r\n            }\r\n        }\r\n        case SET_CURRENT_PAGE: {\r\n            return {...state, currentPage: action.currentPage}\r\n        }\r\n        case SET_TOTAL_USERS_COUNT: {\r\n            return {...state, totalUsersCount: action.totalCount}\r\n        }\r\n        case ON_NUMBER_CHANGE: {\r\n            return {...state, numberChange: action.number}\r\n        }\r\n        case SEARCH_NUMBER: {\r\n            if (state.numberChange >= 1 && state.numberChange <= state.totalUsersCount / state.pageSize) {\r\n                return {...state, currentPage: state.numberChange}\r\n            } else {\r\n                return {...state, currentPage: 1}\r\n            }\r\n        }\r\n        case TOGGLE_IS_FETCHING: {\r\n            {\r\n                return {...state, isFetching: action.isFetching}\r\n            }\r\n        }\r\n        case TOGGLE_IS_FETCHING_PROGRESS: {\r\n            {\r\n                return {\r\n                    ...state,\r\n                    followingInProgress: action.isFetching\r\n                        ? [...state.followingInProgress, action.userId]\r\n                        : state.followingInProgress.filter(id => id != action.userId)\r\n                }\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n    //return state;\r\n}\r\nexport const follow = (userId) => {\r\n    return {\r\n        type: FOLLOW,\r\n        userId,\r\n    }\r\n}\r\nexport const unFollow = (userId) => {\r\n    return {\r\n        type: UNFOLLOW,\r\n        userId,\r\n    }\r\n}\r\nexport const setUsers = (users) => {\r\n    return {type: SET_USERS, users}\r\n};\r\nexport const setCurrentPage = (currentPage) => {\r\n    return {type: SET_CURRENT_PAGE, currentPage}\r\n};\r\nexport const setTotalUsersCount = (totalCount) => {\r\n    return {type: SET_TOTAL_USERS_COUNT, totalCount}\r\n};\r\nexport const onNumberChange = (number) => {\r\n    return {type: ON_NUMBER_CHANGE, number}\r\n};\r\nexport const searchNumber = () => {\r\n    return {type: SEARCH_NUMBER}\r\n};\r\nexport const toggleIsFetching = (isFetching) => {\r\n    return {type: TOGGLE_IS_FETCHING, isFetching}\r\n};\r\nexport const toggleIsFetchingProgress = (isFetching, userId) => {\r\n    return {type: TOGGLE_IS_FETCHING_PROGRESS, isFetching, userId}\r\n}\r\nexport const getUsersThunk = (dispatch) => {\r\n    dispatch (toggleIsFetching(true));\r\n    userAPI.getUsers(this.props.currentPage, this.props.pageSize).then(data => {\r\n        dispatch (toggleIsFetching(false));\r\n        dispatch (setUsers(data.items));\r\n        dispatch (setTotalUsersCount(data.totalCount));\r\n    });\r\n}"]},"metadata":{},"sourceType":"module"}